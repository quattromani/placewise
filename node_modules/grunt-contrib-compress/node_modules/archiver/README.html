<!DOCTYPE  html>
<html>
  <head>
    <meta charset="utf-8">
    
    <title>doc</title>
    <style>
      /*github.com style (c) Vasily Polovnyov <vast@whiteants.net>*/
      pre code {
        display: block; padding: 0.5em;
        color: #333;
        background: #f8f8ff
      }
      pre .comment,
      pre .template_comment,
      pre .diff .header,
      pre .javadoc {
        color: #998;
        font-style: italic
      }
      pre .keyword,
      pre .css .rule .keyword,
      pre .winutils,
      pre .javascript .title,
      pre .nginx .title,
      pre .subst,
      pre .request,
      pre .status {
        color: #333;
        font-weight: bold
      }
      pre .number,
      pre .hexcolor,
      pre .ruby .constant {
        color: #099;
      }
      pre .string,
      pre .tag .value,
      pre .phpdoc,
      pre .tex .formula {
        color: #d14
      }
      pre .title,
      pre .id {
        color: #900;
        font-weight: bold
      }
      pre .javascript .title,
      pre .lisp .title,
      pre .clojure .title,
      pre .subst {
        font-weight: normal
      }
      pre .class .title,
      pre .haskell .type,
      pre .vhdl .literal,
      pre .tex .command {
        color: #458;
        font-weight: bold
      }
      pre .tag,
      pre .tag .title,
      pre .rules .property,
      pre .django .tag .keyword {
        color: #000080;
        font-weight: normal
      }
      pre .attribute,
      pre .variable,
      pre .lisp .body {
        color: #008080
      }
      pre .regexp {
        color: #009926
      }
      pre .class {
        color: #458;
        font-weight: bold
      }
      pre .symbol,
      pre .ruby .symbol .string,
      pre .lisp .keyword,
      pre .tex .special,
      pre .prompt {
        color: #990073
      }
      pre .built_in,
      pre .lisp .title,
      pre .clojure .built_in {
        color: #0086b3
      }
      pre .preprocessor,
      pre .pi,
      pre .doctype,
      pre .shebang,
      pre .cdata {
        color: #999;
        font-weight: bold
      }
      pre .deletion {
        background: #fdd
      }
      pre .addition {
        background: #dfd
      }
      pre .diff .change {
        background: #0086b3
      }
      pre .chunk {
        color: #aaa
      }
    </style>
  </head>
  <body>  
    <h1 id="archiver-v0-13-0-build-status-https-travis-ci-org-ctalkington-node-archiver-svg-branch-master-https-travis-ci-org-ctalkington-node-archiver-">Archiver v0.13.0 <a href="https://travis-ci.org/ctalkington/node-archiver"><img src="https://travis-ci.org/ctalkington/node-archiver.svg?branch=master" alt="Build Status"></a></h1>
<p>a streaming interface for archive generation</p>
<p><a href="https://nodei.co/npm/archiver/"><img src="https://nodei.co/npm/archiver.png" alt="NPM"></a></p>
<h2 id="install">Install</h2>
<pre><code class="lang-bash">npm install archiver --save</code></pre>
<p>You can also use <code>npm install https://github.com/ctalkington/node-archiver/archive/master.tar.gz</code> to test upcoming versions.</p>
<h2 id="archiver">Archiver</h2>
<h4 id="create-format-options-">create(format, options)</h4>
<p>Creates an Archiver instance based on the format (zip, tar, etc) passed. Parameters can be passed directly to <code>Archiver</code> constructor for convenience.</p>
<h4 id="registerformat-format-module-">registerFormat(format, module)</h4>
<p>Registers an archive format. Format modules are essentially transform streams with a few required methods. They will be further documented once a formal spec is in place.</p>
<h3 id="instance-methods">Instance Methods</h3>
<p>Inherits <a href="http://nodejs.org/api/stream.html#stream_class_stream_transform">Transform Stream</a> methods.</p>
<h4 id="abort-">abort()</h4>
<p>Aborts the archiving process, taking a best-effort approach, by:</p>
<ul>
<li>removing any pending queue tasks</li>
<li>allowing any active queue workers to finish</li>
<li>detaching internal module pipes</li>
<li>ending both sides of the Transform stream</li>
</ul>
<p><em>It will NOT drain any remaining sources.</em></p>
<h4 id="append-input-data-">append(input, data)</h4>
<p>Appends an input source (text string, buffer, or stream) to the instance. When the instance has received, processed, and emitted the input, the <code>entry</code> event is fired.</p>
<p>Replaced <code>#addFile</code> in v0.5.</p>
<pre><code class="lang-js">archive.append(&#39;string&#39;, { name:&#39;string.txt&#39; });
archive.append(new Buffer(&#39;string&#39;), { name:&#39;buffer.txt&#39; });
archive.append(fs.createReadStream(&#39;mydir/file.txt&#39;), { name:&#39;stream.txt&#39; });
archive.append(null, { name:&#39;dir/&#39; });</code></pre>
<h4 id="bulk-mappings-">bulk(mappings)</h4>
<p>Appends multiple entries from passed array of src-dest mappings. A <a href="https://github.com/jpommerening/node-lazystream">lazystream</a> wrapper is used to prevent issues with open file limits.</p>
<p>Globbing patterns are supported through use of the <a href="https://github.com/SBoudrias/file-utils">file-utils</a> package. Please note that multiple src files to single dest file (ie concat) is not supported.</p>
<p>The <code>data</code> property can be set (per src-dest mapping) to define data for matched entries.</p>
<pre><code class="lang-js">archive.bulk([
  { src: [&#39;mydir/**&#39;], data: { date: new Date() } },
  { expand: true, cwd: &#39;mydir&#39;, src: [&#39;**&#39;], dest: &#39;newdir&#39; }
]);</code></pre>
<p>For more detail on this feature, please see <a href="https://github.com/ctalkington/node-archiver/blob/master/BULK.md">BULK.md</a>.</p>
<h4 id="file-filepath-data-">file(filepath, data)</h4>
<p>Appends a file given its filepath using a <a href="https://github.com/jpommerening/node-lazystream">lazystream</a> wrapper to prevent issues with open file limits. When the instance has received, processed, and emitted the file, the <code>entry</code> event is fired.</p>
<pre><code class="lang-js">archive.file(&#39;mydir/file.txt&#39;, { name:&#39;file.txt&#39; });</code></pre>
<h4 id="finalize-">finalize()</h4>
<p>Finalizes the instance and prevents further appending to the archive structure (queue will continue til drained). The <code>end</code>, <code>close</code> or <code>finish</code> events on the destination stream may fire right after calling this method so you should set listeners beforehand to properly detect stream completion.</p>
<p><em>You must call this method to get a valid archive and end the instance stream.</em></p>
<h4 id="pointer-">pointer()</h4>
<p>Returns the current byte length emitted by archiver. Use this in your end callback to log generated size.</p>
<h2 id="events">Events</h2>
<p>Inherits <a href="http://nodejs.org/api/stream.html#stream_class_stream_transform">Transform Stream</a> events.</p>
<h4 id="entry">entry</h4>
<p>Fired when the input has been received, processed, and emitted. Passes entry data as first argument.</p>
<h2 id="zip">Zip</h2>
<h3 id="options">Options</h3>
<h4 id="comment-string-">comment <code>string</code></h4>
<p>Sets the zip comment.</p>
<h4 id="statconcurrency-number-">statConcurrency <code>number</code></h4>
<p>Sets the number of workers used to process the internal fs stat queue. Defaults to 4.</p>
<h4 id="store-boolean-">store <code>boolean</code></h4>
<p>If true, all entries will be archived without compression. Defaults to <code>false</code>.</p>
<h4 id="zlib-object-">zlib <code>object</code></h4>
<p>Passed to node&#39;s <a href="http://nodejs.org/api/zlib.html#zlib_options">zlib</a> module to control compression. Options may vary by node version.</p>
<h3 id="entry-data">Entry Data</h3>
<h4 id="name-string-required-">name <code>string</code> <code>required</code></h4>
<p>Sets the entry name including internal path.</p>
<h4 id="date-string-date-">date <code>string|Date</code></h4>
<p>Sets the entry date. This can be any valid date string or instance. Defaults to current time in locale.</p>
<p>When using the <code>bulk</code> or <code>file</code> methods, fs stat data is used as the default value.</p>
<h4 id="store-boolean-">store <code>boolean</code></h4>
<p>If true, this entry will be archived without compression. Defaults to global <code>store</code> option.</p>
<h4 id="comment-string-">comment <code>string</code></h4>
<p>Sets the entry comment.</p>
<h4 id="mode-number-">mode <code>number</code></h4>
<p>Sets the entry permissions. Defaults to octal 0755 (directory) or 0644 (file).</p>
<p>When using the <code>bulk</code> or <code>file</code> methods, fs stat data is used as the default value.</p>
<h4 id="stats-fs-stats-">stats <code>fs.Stats</code></h4>
<p>Sets the fs stat data for this entry. This allows for reduction of fs stat calls when stat data is already known.</p>
<h2 id="tar">Tar</h2>
<h3 id="options">Options</h3>
<h4 id="gzip-boolean-">gzip <code>boolean</code></h4>
<p>Compresses the tar archive using gzip, default is false.</p>
<h4 id="gzipoptions-object-">gzipOptions <code>object</code></h4>
<p>Passed to node&#39;s <a href="http://nodejs.org/api/zlib.html#zlib_options">zlib</a> module to control compression. Options may vary by node version.</p>
<h4 id="statconcurrency-number-">statConcurrency <code>number</code></h4>
<p>Sets the number of workers used to process the internal fs stat queue. Defaults to 4.</p>
<h3 id="entry-data">Entry Data</h3>
<h4 id="name-string-required-">name <code>string</code> <code>required</code></h4>
<p>Sets the entry name including internal path.</p>
<h4 id="date-string-date-">date <code>string|Date</code></h4>
<p>Sets the entry date. This can be any valid date string or instance. Defaults to current time in locale.</p>
<p>When using the <code>bulk</code> or <code>file</code> methods, fs stat data is used as the default value.</p>
<h4 id="mode-number-">mode <code>number</code></h4>
<p>Sets the entry permissions. Defaults to octal 0755 (directory) or 0644 (file).</p>
<p>When using the <code>bulk</code> or <code>file</code> methods, fs stat data is used as the default value.</p>
<h4 id="stats-fs-stats-">stats <code>fs.Stats</code></h4>
<p>Sets the fs stat data for this entry. This allows for reduction of fs stat calls when stat data is already known.</p>
<h2 id="libraries">Libraries</h2>
<p>Archiver makes use of several libraries/modules to avoid duplication of efforts.</p>
<ul>
<li><a href="https://npmjs.org/package/zip-stream">zip-stream</a></li>
<li><a href="https://npmjs.org/package/tar-stream">tar-stream</a></li>
</ul>
<h2 id="things-of-interest">Things of Interest</h2>
<ul>
<li><a href="https://docsrc.com/archiver/">Source Docs (coming soon)</a></li>
<li><a href="https://github.com/ctalkington/node-archiver/blob/master/examples">Examples</a></li>
<li><a href="https://github.com/ctalkington/node-archiver/releases">Changelog</a></li>
<li><a href="https://github.com/ctalkington/node-archiver/blob/master/CONTRIBUTING.md">Contributing</a></li>
<li><a href="https://github.com/ctalkington/node-archiver/blob/master/LICENSE-MIT">MIT License</a></li>
</ul>

  </body>
</html>
