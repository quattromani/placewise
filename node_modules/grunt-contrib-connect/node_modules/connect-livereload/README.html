<!DOCTYPE  html>
<html>
  <head>
    <meta charset="utf-8">
    
    <title>doc</title>
    <style>
      /*github.com style (c) Vasily Polovnyov <vast@whiteants.net>*/
      pre code {
        display: block; padding: 0.5em;
        color: #333;
        background: #f8f8ff
      }
      pre .comment,
      pre .template_comment,
      pre .diff .header,
      pre .javadoc {
        color: #998;
        font-style: italic
      }
      pre .keyword,
      pre .css .rule .keyword,
      pre .winutils,
      pre .javascript .title,
      pre .nginx .title,
      pre .subst,
      pre .request,
      pre .status {
        color: #333;
        font-weight: bold
      }
      pre .number,
      pre .hexcolor,
      pre .ruby .constant {
        color: #099;
      }
      pre .string,
      pre .tag .value,
      pre .phpdoc,
      pre .tex .formula {
        color: #d14
      }
      pre .title,
      pre .id {
        color: #900;
        font-weight: bold
      }
      pre .javascript .title,
      pre .lisp .title,
      pre .clojure .title,
      pre .subst {
        font-weight: normal
      }
      pre .class .title,
      pre .haskell .type,
      pre .vhdl .literal,
      pre .tex .command {
        color: #458;
        font-weight: bold
      }
      pre .tag,
      pre .tag .title,
      pre .rules .property,
      pre .django .tag .keyword {
        color: #000080;
        font-weight: normal
      }
      pre .attribute,
      pre .variable,
      pre .lisp .body {
        color: #008080
      }
      pre .regexp {
        color: #009926
      }
      pre .class {
        color: #458;
        font-weight: bold
      }
      pre .symbol,
      pre .ruby .symbol .string,
      pre .lisp .keyword,
      pre .tex .special,
      pre .prompt {
        color: #990073
      }
      pre .built_in,
      pre .lisp .title,
      pre .clojure .built_in {
        color: #0086b3
      }
      pre .preprocessor,
      pre .pi,
      pre .doctype,
      pre .shebang,
      pre .cdata {
        color: #999;
        font-weight: bold
      }
      pre .deletion {
        background: #fdd
      }
      pre .addition {
        background: #dfd
      }
      pre .diff .change {
        background: #0086b3
      }
      pre .chunk {
        color: #aaa
      }
    </style>
  </head>
  <body>  
    <h1 id="connect-livereload">connect-livereload</h1>
<p>connect middleware for adding the livereload script to the response.
no browser plugin is needed.
if you are happy with a browser plugin, then you don&#39;t need this middleware.</p>
<p><a href="https://travis-ci.org/intesso/connect-livereload"><img src="https://travis-ci.org/intesso/connect-livereload.png" alt="Build Status"></a>
<a href="http://badge.fury.io/js/connect-livereload"><img src="https://badge.fury.io/js/connect-livereload.png" alt="NPM version"></a></p>
<h1 id="install">install</h1>
<pre><code class="lang-bash">npm install connect-livereload --save-dev</code></pre>
<h1 id="use">use</h1>
<p>note: if you use this middleware, you should make sure to switch off the Browser LiveReload Extension if you have it installed.</p>
<p>this middleware can be used with a LiveReload module e.g. <a href="https://github.com/gruntjs/grunt-contrib-connect">grunt-contrib-connect</a> or <a href="https://github.com/gruntjs/grunt-contrib-watch">grunt-contrib-watch</a>.</p>
<p><code>connect-livereload</code> itself does not serve the <code>livereload.js</code> script.</p>
<p>In your connect or express application add this after the static and before the dynamic routes.
If you need liveReload on static html files, then place it before the static routes.
<code>ignore</code> gives you the possibility to ignore certain files or url&#39;s from being handled by <code>connect-livereload</code>.</p>
<h2 id="connect-express-example">connect/express example</h2>
<pre><code class="lang-javascript">  app.use(require(&#39;connect-livereload&#39;)({
    port: 35729
  }));</code></pre>
<p>please see the <a href="https://github.com/intesso/connect-livereload/tree/master/examples">examples</a> for the app and Grunt configuration.</p>
<h2 id="options">options</h2>
<p>Options are not mandatory: <code>app.use(require(&#39;connect-livereload&#39;)());</code>
The Options have to be provided when the middleware is loaded:</p>
<p>e.g.:</p>
<pre><code>  app.use(require(&#39;connect-livereload&#39;)({
    port: 35729,
    ignore: [&#39;.js&#39;, &#39;.svg&#39;]
  }));</code></pre>
<p>These are the available options with the following defaults:</p>
<pre><code class="lang-javascript">  // `ignore` and `include`: array with strings and regex expressions elements.
  // strings: included/ignored when the url contains this string
  // regex: any expression: e.g. starts with pattern: /^.../ ends with pattern: /...$/
  ignore: [/\.js$/, /\.css$/, /\.svg$/, /\.ico$/, /\.woff$/, /\.png$/, /\.jpg$/, /\.jpeg$/],

  // include all urls by default
  include: [/.*/],

  // this function is used to determine if the content of `res.write` or `res.end` is html.
  html: function (str) {
    return /&lt;[:_-\w\s\!\/\=\&quot;\&#39;]+&gt;/i.test(str);
  },

  // rules are provided to find the place where the snippet should be inserted.
  // the main problem is that on the server side it can be tricky to determine if a string will be valid html on the client.
  // the function `fn` of the first `match` is executed like this `body.replace(rule.match, rule.fn);`
  // the function `fn` has got the arguments `fn(w, s)` where `w` is the matches string and `s` is the snippet.
  rules: [{
    match: /&lt;\/body&gt;(?![\s\S]*&lt;\/body&gt;)/,
    fn: prepend
  }, {
    match: /&lt;\/html&gt;(?![\s\S]*&lt;\/html&gt;)/,
    fn: prepend
  }, {
    match: /&lt;\!DOCTYPE.+&gt;/,
    fn: append
  }],

  // port where the script is loaded
  port: 35729,

  // location where the script is provided (not by connect-livereload). Change this e.g. when serving livereload with a proxy.
  src: &quot;http://localhost:35729/livereload.js?snipver=1&quot;,</code></pre>
<p>please see the <a href="https://github.com/intesso/connect-livereload/tree/master/examples">examples</a> for the app and Grunt configuration.</p>
<h2 id="grunt-example">grunt example</h2>
<p>The following example is from an actual Gruntfile that uses <a href="https://github.com/gruntjs/grunt-contrib-connect">grunt-contrib-connect</a></p>
<pre><code class="lang-javascript">connect: {
  options: {
    port: 3000,
    hostname: &#39;localhost&#39;
  },
  dev: {
    options: {
      middleware: function (connect) {
        return [
          require(&#39;connect-livereload&#39;)(), // &lt;--- here
          checkForDownload,
          mountFolder(connect, &#39;.tmp&#39;),
          mountFolder(connect, &#39;app&#39;)
        ];
      }
    }
  }
}</code></pre>
<p>For use as middleware in grunt simply add the following to the <strong>top</strong> of your array of middleware.</p>
<pre><code class="lang-javascript">  require(&#39;connect-livereload&#39;)(),</code></pre>
<p>You can pass in options to this call if you do not want the defaults.</p>
<p><code>dev</code> is simply the name of the server being used with the task <code>grunt connect:dev</code>. The other items in the <code>middleware</code> array are all functions that either are of the form <code>function (req, res, next)</code> like <code>checkForDownload</code> or return that like <code>mountFolder(connect, &#39;something&#39;)</code>.</p>
<h1 id="alternative">alternative</h1>
<p>An alternative would be to install the <a href="https://chrome.google.com/webstore/detail/livereload/jnihajbhpnppcggbcgedagnkighmdlei">LiveReload browser plugin</a>.</p>
<h1 id="credits">credits</h1>
<ul>
<li>The initial middleware code was mainly extracted from: <a href="https://github.com/gruntjs/grunt-contrib-livereload/blob/master/lib/utils.js">grunt-contrib-livereload/util.js</a></li>
<li><a href="http://livereload.com/">LiveReload Creator</a></li>
</ul>
<h1 id="tests">tests</h1>
<p>run the tests with</p>
<pre><code>mocha</code></pre>
<h1 id="license">license</h1>
<p><a href="https://github.com/intesso/connect-livereload/blob/master/LICENSE">MIT License</a></p>

  </body>
</html>
