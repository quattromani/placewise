<!DOCTYPE  html>
<html>
  <head>
    <meta charset="utf-8">
    
    <title>doc</title>
    <style>
      /*github.com style (c) Vasily Polovnyov <vast@whiteants.net>*/
      pre code {
        display: block; padding: 0.5em;
        color: #333;
        background: #f8f8ff
      }
      pre .comment,
      pre .template_comment,
      pre .diff .header,
      pre .javadoc {
        color: #998;
        font-style: italic
      }
      pre .keyword,
      pre .css .rule .keyword,
      pre .winutils,
      pre .javascript .title,
      pre .nginx .title,
      pre .subst,
      pre .request,
      pre .status {
        color: #333;
        font-weight: bold
      }
      pre .number,
      pre .hexcolor,
      pre .ruby .constant {
        color: #099;
      }
      pre .string,
      pre .tag .value,
      pre .phpdoc,
      pre .tex .formula {
        color: #d14
      }
      pre .title,
      pre .id {
        color: #900;
        font-weight: bold
      }
      pre .javascript .title,
      pre .lisp .title,
      pre .clojure .title,
      pre .subst {
        font-weight: normal
      }
      pre .class .title,
      pre .haskell .type,
      pre .vhdl .literal,
      pre .tex .command {
        color: #458;
        font-weight: bold
      }
      pre .tag,
      pre .tag .title,
      pre .rules .property,
      pre .django .tag .keyword {
        color: #000080;
        font-weight: normal
      }
      pre .attribute,
      pre .variable,
      pre .lisp .body {
        color: #008080
      }
      pre .regexp {
        color: #009926
      }
      pre .class {
        color: #458;
        font-weight: bold
      }
      pre .symbol,
      pre .ruby .symbol .string,
      pre .lisp .keyword,
      pre .tex .special,
      pre .prompt {
        color: #990073
      }
      pre .built_in,
      pre .lisp .title,
      pre .clojure .built_in {
        color: #0086b3
      }
      pre .preprocessor,
      pre .pi,
      pre .doctype,
      pre .shebang,
      pre .cdata {
        color: #999;
        font-weight: bold
      }
      pre .deletion {
        background: #fdd
      }
      pre .addition {
        background: #dfd
      }
      pre .diff .change {
        background: #0086b3
      }
      pre .chunk {
        color: #aaa
      }
    </style>
  </head>
  <body>  
    <h1 id="morgan">morgan</h1>
<p><a href="https://npmjs.org/package/morgan"><img src="https://img.shields.io/npm/v/morgan.svg?style=flat" alt="NPM Version"></a>
<a href="https://npmjs.org/package/morgan"><img src="https://img.shields.io/npm/dm/morgan.svg?style=flat" alt="NPM Downloads"></a>
<a href="https://travis-ci.org/expressjs/morgan"><img src="https://img.shields.io/travis/expressjs/morgan.svg?style=flat" alt="Build Status"></a>
<a href="https://coveralls.io/r/expressjs/morgan?branch=master"><img src="https://img.shields.io/coveralls/expressjs/morgan.svg?style=flat" alt="Test Coverage"></a>
<a href="https://www.gratipay.com/dougwilson/"><img src="https://img.shields.io/gratipay/dougwilson.svg?style=flat" alt="Gratipay"></a></p>
<p>HTTP request logger middleware for node.js</p>
<blockquote>
<p>Named after <a href="http://en.wikipedia.org/wiki/Dexter_Morgan">Dexter</a>, a show you should not watch until completion.</p>
</blockquote>
<h2 id="api">API</h2>
<pre><code class="lang-js">var morgan = require(&#39;morgan&#39;)</code></pre>
<h3 id="morgan-format-options-">morgan(format, options)</h3>
<p>Create a new morgan logger middleware function using the given <code>format</code> and <code>options</code>.
The <code>format</code> argument may be a string of a predefined name (see below for the names),
a string of a format string, or a function that will produce a log entry.</p>
<h4 id="options">Options</h4>
<p>Morgan accepts these properties in the options object.</p>
<h4 id="buffer">buffer</h4>
<p>Buffer duration before writing logs to the <code>stream</code>, defaults to <code>false</code>. When
set to <code>true</code>, defaults to <code>1000 ms</code>.</p>
<h4 id="immediate">immediate</h4>
<p>Write log line on request instead of response. This means that a requests will
be logged even if the server crashes, <em>but data from the response (like the
response code, content length, etc.) cannot be logged</em>.</p>
<h5 id="skip">skip</h5>
<p>Function to determine if logging is skipped, defaults to <code>false</code>. This function
will be called as <code>skip(req, res)</code>.</p>
<pre><code class="lang-js">// EXAMPLE: only log error responses
morgan(&#39;combined&#39;, {
  skip: function (req, res) { return res.statusCode &lt; 400 }
})</code></pre>
<h5 id="stream">stream</h5>
<p>Output stream for writing log lines, defaults to <code>process.stdout</code>.</p>
<h4 id="predefined-formats">Predefined Formats</h4>
<p>There are various pre-defined formats provided:</p>
<h5 id="combined">combined</h5>
<p>Standard Apache combined log output.</p>
<pre><code>:remote-addr - :remote-user [:date] &quot;:method :url HTTP/:http-version&quot; :status :res[content-length] &quot;:referrer&quot; &quot;:user-agent&quot;</code></pre>
<h5 id="common">common</h5>
<p>Standard Apache common log output.</p>
<pre><code>:remote-addr - :remote-user [:date] &quot;:method :url HTTP/:http-version&quot; :status :res[content-length]</code></pre>
<h5 id="dev">dev</h5>
<p>Concise output colored by response status for development use. The <code>:status</code>
token will be colored red for server error codes, yellow for client error
codes, cyan for redirection codes, and uncolored for all other codes.</p>
<pre><code>:method :url :status :response-time ms - :res[content-length]</code></pre>
<h5 id="short">short</h5>
<p>Shorter than default, also including response time.</p>
<pre><code>:remote-addr :remote-user :method :url HTTP/:http-version :status :res[content-length] - :response-time ms</code></pre>
<h5 id="tiny">tiny</h5>
<p>The minimal output.</p>
<pre><code>:method :url :status :res[content-length] - :response-time ms</code></pre>
<h4 id="tokens">Tokens</h4>
<ul>
<li><code>:req[header]</code> ex: <code>:req[Accept]</code></li>
<li><code>:res[header]</code> ex: <code>:res[Content-Length]</code></li>
<li><code>:http-version</code></li>
<li><code>:response-time</code></li>
<li><code>:remote-addr</code></li>
<li><code>:remote-user</code></li>
<li><code>:date</code></li>
<li><code>:method</code></li>
<li><code>:url</code></li>
<li><code>:referrer</code></li>
<li><code>:user-agent</code></li>
<li><code>:status</code></li>
</ul>
<p>To define a token, simply invoke <code>morgan.token()</code> with the name and a callback function. The value returned is then available as &quot;:type&quot; in this case:</p>
<pre><code class="lang-js">morgan.token(&#39;type&#39;, function(req, res){ return req.headers[&#39;content-type&#39;]; })</code></pre>
<p>Calling <code>morgan.token()</code> using the same name as an existing token will overwrite that token definition.</p>
<h2 id="examples">Examples</h2>
<h3 id="express-connect">express/connect</h3>
<p>Simple app that will log all request in the Apache combined format to STDOUT</p>
<pre><code class="lang-js">var express = require(&#39;express&#39;)
var morgan = require(&#39;morgan&#39;)

var app = express()

app.use(morgan(&#39;combined&#39;))

app.get(&#39;/&#39;, function (req, res) {
  res.send(&#39;hello, world!&#39;)
})</code></pre>
<h3 id="vanilla-http-server">vanilla http server</h3>
<p>Simple app that will log all request in the Apache combined format to STDOUT</p>
<pre><code class="lang-js">var finalhandler = require(&#39;finalhandler&#39;)
var http = require(&#39;http&#39;)
var morgan = require(&#39;morgan&#39;)

// create &quot;middleware&quot;
var logger = morgan(&#39;combined&#39;)

http.createServer(function (req, res) {
  var done = finalhandler(req, res)
  logger(req, res, function (err) {
    if (err) return done(err)

    // respond to request
    res.setHeader(&#39;content-type&#39;, &#39;text/plain&#39;)
    res.end(&#39;hello, world!&#39;)
  })
})</code></pre>
<h3 id="write-logs-to-a-file">write logs to a file</h3>
<p>Simple app that will log all request in the Apache combined format to the file &quot;access.log&quot;</p>
<pre><code class="lang-js">var express = require(&#39;express&#39;)
var fs = require(&#39;fs&#39;)
var morgan = require(&#39;morgan&#39;)

var app = express()

// create a write stream (in append mode)
var accessLogStream = fs.createWriteStream(__dirname + &#39;/access.log&#39;, {flags: &#39;a&#39;})

// setup the logger
app.use(morgan(&#39;combined&#39;, {stream: accessLogStream}))

app.get(&#39;/&#39;, function (req, res) {
  res.send(&#39;hello, world!&#39;)
})</code></pre>
<h3 id="use-custom-token-formats">use custom token formats</h3>
<p>Sample app that will use custom token formats like changing the &quot;:date&quot;</p>
<pre><code class="lang-js">var express = require(&#39;express&#39;)
var morgan = require(&#39;morgan&#39;)

// alter :date token format
// ex. 2011-10-05T14:48:00.000Z
morgan.token(&#39;date&#39;, function () {
  return new Date().toISOString()
})

var app = express()

app.use(morgan(&#39;combined&#39;))

app.get(&#39;/&#39;, function (req, res) {
  res.send(&#39;hello, world!&#39;)
})</code></pre>
<h2 id="license">License</h2>
<p><a href="LICENSE">MIT</a></p>

  </body>
</html>
