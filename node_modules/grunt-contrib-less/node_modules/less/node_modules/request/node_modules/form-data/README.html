<!DOCTYPE  html>
<html>
  <head>
    <meta charset="utf-8">
    
    <title>doc</title>
    <style>
      /*github.com style (c) Vasily Polovnyov <vast@whiteants.net>*/
      pre code {
        display: block; padding: 0.5em;
        color: #333;
        background: #f8f8ff
      }
      pre .comment,
      pre .template_comment,
      pre .diff .header,
      pre .javadoc {
        color: #998;
        font-style: italic
      }
      pre .keyword,
      pre .css .rule .keyword,
      pre .winutils,
      pre .javascript .title,
      pre .nginx .title,
      pre .subst,
      pre .request,
      pre .status {
        color: #333;
        font-weight: bold
      }
      pre .number,
      pre .hexcolor,
      pre .ruby .constant {
        color: #099;
      }
      pre .string,
      pre .tag .value,
      pre .phpdoc,
      pre .tex .formula {
        color: #d14
      }
      pre .title,
      pre .id {
        color: #900;
        font-weight: bold
      }
      pre .javascript .title,
      pre .lisp .title,
      pre .clojure .title,
      pre .subst {
        font-weight: normal
      }
      pre .class .title,
      pre .haskell .type,
      pre .vhdl .literal,
      pre .tex .command {
        color: #458;
        font-weight: bold
      }
      pre .tag,
      pre .tag .title,
      pre .rules .property,
      pre .django .tag .keyword {
        color: #000080;
        font-weight: normal
      }
      pre .attribute,
      pre .variable,
      pre .lisp .body {
        color: #008080
      }
      pre .regexp {
        color: #009926
      }
      pre .class {
        color: #458;
        font-weight: bold
      }
      pre .symbol,
      pre .ruby .symbol .string,
      pre .lisp .keyword,
      pre .tex .special,
      pre .prompt {
        color: #990073
      }
      pre .built_in,
      pre .lisp .title,
      pre .clojure .built_in {
        color: #0086b3
      }
      pre .preprocessor,
      pre .pi,
      pre .doctype,
      pre .shebang,
      pre .cdata {
        color: #999;
        font-weight: bold
      }
      pre .deletion {
        background: #fdd
      }
      pre .addition {
        background: #dfd
      }
      pre .diff .change {
        background: #0086b3
      }
      pre .chunk {
        color: #aaa
      }
    </style>
  </head>
  <body>  
    <h1 id="form-data-build-status-https-travis-ci-org-felixge-node-form-data-png-branch-master-https-travis-ci-org-felixge-node-form-data-dependency-status-https-gemnasium-com-felixge-node-form-data-png-https-gemnasium-com-felixge-node-form-data-">Form-Data <a href="https://travis-ci.org/felixge/node-form-data"><img src="https://travis-ci.org/felixge/node-form-data.png?branch=master" alt="Build Status"></a> <a href="https://gemnasium.com/felixge/node-form-data"><img src="https://gemnasium.com/felixge/node-form-data.png" alt="Dependency Status"></a></h1>
<p>A module to create readable <code>&quot;multipart/form-data&quot;</code> streams. Can be used to submit forms and file uploads to other web applications.</p>
<p>The API of this module is inspired by the <a href="http://dev.w3.org/2006/webapi/XMLHttpRequest-2/Overview.html#the-formdata-interface">XMLHttpRequest-2 FormData Interface</a>.</p>
<h2 id="install">Install</h2>
<pre><code>npm install form-data</code></pre>
<h2 id="usage">Usage</h2>
<p>In this example we are constructing a form with 3 fields that contain a string,
a buffer and a file stream.</p>
<pre><code class="lang-javascript">var FormData = require(&#39;form-data&#39;);
var fs = require(&#39;fs&#39;);

var form = new FormData();
form.append(&#39;my_field&#39;, &#39;my value&#39;);
form.append(&#39;my_buffer&#39;, new Buffer(10));
form.append(&#39;my_file&#39;, fs.createReadStream(&#39;/foo/bar.jpg&#39;));</code></pre>
<p>Also you can use http-response stream:</p>
<pre><code class="lang-javascript">var FormData = require(&#39;form-data&#39;);
var http = require(&#39;http&#39;);

var form = new FormData();

http.request(&#39;http://nodejs.org/images/logo.png&#39;, function(response) {
  form.append(&#39;my_field&#39;, &#39;my value&#39;);
  form.append(&#39;my_buffer&#39;, new Buffer(10));
  form.append(&#39;my_logo&#39;, response);
});</code></pre>
<p>Or @mikeal&#39;s request stream:</p>
<pre><code class="lang-javascript">var FormData = require(&#39;form-data&#39;);
var request = require(&#39;request&#39;);

var form = new FormData();

form.append(&#39;my_field&#39;, &#39;my value&#39;);
form.append(&#39;my_buffer&#39;, new Buffer(10));
form.append(&#39;my_logo&#39;, request(&#39;http://nodejs.org/images/logo.png&#39;));</code></pre>
<p>In order to submit this form to a web application, call <code>submit(url, [callback])</code> method:</p>
<pre><code class="lang-javascript">form.submit(&#39;http://example.org/&#39;, function(err, res) {
  // res â€“ response object (http.IncomingMessage)  //
  res.resume(); // for node-0.10.x
});</code></pre>
<p>For more advanced request manipulations <code>submit()</code> method returns <code>http.ClientRequest</code> object, or you can choose from one of the alternative submission methods.</p>
<h3 id="alternative-submission-methods">Alternative submission methods</h3>
<p>You can use node&#39;s http client interface:</p>
<pre><code class="lang-javascript">var http = require(&#39;http&#39;);

var request = http.request({
  method: &#39;post&#39;,
  host: &#39;example.org&#39;,
  path: &#39;/upload&#39;,
  headers: form.getHeaders()
});

form.pipe(request);

request.on(&#39;response&#39;, function(res) {
  console.log(res.statusCode);
});</code></pre>
<p>Or if you would prefer the <code>&#39;Content-Length&#39;</code> header to be set for you:</p>
<pre><code class="lang-javascript">form.submit(&#39;example.org/upload&#39;, function(err, res) {
  console.log(res.statusCode);
});</code></pre>
<p>To use custom headers and pre-known length in parts:</p>
<pre><code class="lang-javascript">var CRLF = &#39;\r\n&#39;;
var form = new FormData();

var options = {
  header: CRLF + &#39;--&#39; + form.getBoundary() + CRLF + &#39;X-Custom-Header: 123&#39; + CRLF + CRLF,
  knownLength: 1
};

form.append(&#39;my_buffer&#39;, buffer, options);

form.submit(&#39;http://example.com/&#39;, function(err, res) {
  if (err) throw err;
  console.log(&#39;Done&#39;);
});</code></pre>
<p>Form-Data can recognize and fetch all the required information from common types of streams (<code>fs.readStream</code>, <code>http.response</code> and <code>mikeal&#39;s request</code>), for some other types of streams you&#39;d need to provide &quot;file&quot;-related information manually:</p>
<pre><code class="lang-javascript">someModule.stream(function(err, stdout, stderr) {
  if (err) throw err;

  var form = new FormData();

  form.append(&#39;file&#39;, stdout, {
    filename: &#39;unicycle.jpg&#39;,
    contentType: &#39;image/jpg&#39;,
    knownLength: 19806
  });

  form.submit(&#39;http://example.com/&#39;, function(err, res) {
    if (err) throw err;
    console.log(&#39;Done&#39;);
  });
});</code></pre>
<p>For edge cases, like POST request to URL with query string or to pass HTTP auth credentials, object can be passed to <code>form.submit()</code> as first parameter:</p>
<pre><code class="lang-javascript">form.submit({
  host: &#39;example.com&#39;,
  path: &#39;/probably.php?extra=params&#39;,
  auth: &#39;username:password&#39;
}, function(err, res) {
  console.log(res.statusCode);
});</code></pre>
<p>In case you need to also send custom HTTP headers with the POST request, you can use the <code>headers</code> key in first parameter of <code>form.submit()</code>:</p>
<pre><code class="lang-javascript">form.submit({
  host: &#39;example.com&#39;,
  path: &#39;/surelynot.php&#39;,
  headers: {&#39;x-test-header&#39;: &#39;test-header-value&#39;}
}, function(err, res) {
  console.log(res.statusCode);
});</code></pre>
<h2 id="notes">Notes</h2>
<ul>
<li><code>getLengthSync()</code> method DOESN&#39;T calculate length for streams, use <code>knownLength</code> options as workaround.</li>
<li>If it feels like FormData hangs after submit and you&#39;re on <code>node-0.10</code>, please check <a href="http://nodejs.org/api/stream.html#stream_compatibility_with_older_node_versions">Compatibility with Older Node Versions</a></li>
</ul>
<h2 id="todo">TODO</h2>
<ul>
<li>Add new streams (0.10) support and try really hard not to break it for 0.8.x.</li>
</ul>
<h2 id="license">License</h2>
<p>Form-Data is licensed under the MIT license.</p>

  </body>
</html>
